(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9970],{856:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>w});var t=a(5155),l=a(2115),r=a(5695),i=a(6766),n=a(993),c=a(1366),d=a(4835),o=a(9947),x=a(7924),m=a(1886);let h=e=>{let[s,a]=(0,l.useState)([]),[t,r]=(0,l.useState)(0),[i,n]=(0,l.useState)(!1),c=(0,l.useCallback)(async()=>{if(e.isInitialized&&e.isAuthenticated)try{n(!0);let e=(await m.no()).data;a(e),r(e.filter(e=>!e.is_read).length)}catch(e){console.error("Failed to load new messages:",e)}finally{n(!1)}},[e.isInitialized,e.isAuthenticated]),d=(0,l.useCallback)(async function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(e.isInitialized&&e.isAuthenticated)try{n(!0);let e=(await m.sI(s)).data;a(e),r(e.filter(e=>!e.is_read).length)}catch(e){console.error("Failed to load message history:",e)}finally{n(!1)}},[e.isInitialized,e.isAuthenticated]),o=(0,l.useCallback)(async e=>{try{await m.gw(e),a(s=>s.map(s=>s.id===e?{...s,is_read:!0}:s)),r(e=>Math.max(0,e-1))}catch(e){console.error("Failed to mark message as read:",e)}},[]),x=(0,l.useCallback)(async()=>{try{await m.qR(),a(e=>e.map(e=>({...e,is_read:!0}))),r(0)}catch(e){console.error("Failed to mark all messages as read:",e)}},[]);return(0,l.useEffect)(()=>{if(e.isInitialized&&e.isAuthenticated){c();let e=setInterval(c,3e4);return()=>clearInterval(e)}},[e.isInitialized,e.isAuthenticated,c]),{notifications:s,unreadCount:t,loading:i,loadNewMessages:c,loadMessageHistory:d,markAsRead:o,markAllAsRead:x}};var u=a(6874),g=a.n(u),f=a(3786),p=a(437),j=a(4416);let v=e=>{let{isOpen:s,onClose:a}=e,r=(0,n.ii)(),i=h(r),d=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{s&&r.isInitialized&&r.isAuthenticated&&!d.current&&(i.loadMessageHistory(50),d.current=!0),s||(d.current=!1)},[s,r.isInitialized,r.isAuthenticated,i.loadMessageHistory]),(0,l.useEffect)(()=>{if(!s)return;let e=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,a]),(0,t.jsxs)(t.Fragment,{children:[s&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/20 z-40 transition-opacity",onClick:a}),(0,t.jsxs)("div",{className:"\n                fixed left-0 top-0 h-full w-96 bg-white shadow-2xl z-50\n                transform transition-transform duration-300 ease-in-out\n                flex flex-col\n                ".concat(s?"translate-x-0":"-translate-x-full","\n            "),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),i.unreadCount>0&&(0,t.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium text-white bg-red-500 rounded-full",children:i.unreadCount})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g(),{href:"/portal/admin/profile/messages",onClick:a,className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded-lg transition-colors",title:"See all messages",children:(0,t.jsx)(f.A,{className:"w-5 h-5"})}),i.unreadCount>0&&(0,t.jsx)("button",{onClick:i.markAllAsRead,className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded-lg transition-colors",title:"Mark all as read",children:(0,t.jsx)(p.A,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:a,className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded-lg transition-colors",title:"Close",children:(0,t.jsx)(j.A,{className:"w-5 h-5"})})]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:i.loading&&0===i.notifications.length?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("div",{className:"text-gray-400",children:"Loading..."})}):0===i.notifications.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[(0,t.jsx)(c.A,{className:"w-12 h-12 text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 font-medium",children:"No notifications"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"You're all caught up!"})]}):(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:i.notifications.map(e=>(0,t.jsx)("div",{className:"\n                                        p-4 hover:bg-gray-50 transition-colors cursor-pointer\n                                        border-l-4 ".concat((e=>e>=3?"border-l-red-500":e>=2?"border-l-orange-500":e>=1?"border-l-yellow-500":"border-l-blue-500")(e.warn_level),"\n                                        ").concat(e.is_read?"":"bg-blue-50/50","\n                                    "),onClick:()=>{e.is_read||i.markAsRead(e.id)},children:(0,t.jsx)("div",{className:"flex items-start gap-3",children:(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-1",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:e.title}),!e.is_read&&(0,t.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:e.contents}),(0,t.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-gray-600",children:e.type}),(0,t.jsx)("span",{children:(e=>{if(!e)return"";let s=new Date(e),a=new Date().getTime()-s.getTime(),t=Math.floor(a/6e4),l=Math.floor(a/36e5),r=Math.floor(a/864e5);return t<1?"Just now":t<60?"".concat(t,"m ago"):l<24?"".concat(l,"h ago"):r<7?"".concat(r,"d ago"):s.toLocaleDateString()})(e.created_at)})]})})]})})},e.id))})})]})]})};function w(e){let{children:s}=e,[a,r]=(0,l.useState)(!1);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(N,{}),children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(b,{onMessageClick:()=>r(!a)}),(0,t.jsx)("div",{className:"ml-14 w-full",children:s}),(0,t.jsx)(v,{isOpen:a,onClose:()=>r(!1)})]})})})}let b=e=>{let{onMessageClick:s}=e,[a,o]=(0,l.useState)(!1),x=(0,n.ii)(),m=(0,r.useRouter)(),u=h(x);return(0,l.useEffect)(()=>{o(!0)},[]),(0,l.useEffect)(()=>{x.loaded&&(x.isAuthenticated||m.push("/auth/login"))},[x.isAuthenticated,x.loaded]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("nav",{className:"fixed top-0 left-0 w-14 h-full border-r border-gray-200 bg-white space-y-8",children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("div",{className:"h-16 flex items-center justify-center mx-auto",children:(0,t.jsx)("a",{href:"/zz/pages/portal/admin",className:"flex-none",children:(0,t.jsx)(i.default,{src:"/zz/pages/logo.png",alt:"Turnix Logo",width:36,height:36})})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col h-full",children:[(0,t.jsx)("ul",{className:"px-4 text-sm font-medium flex-1 flex flex-col gap-2",children:y.map((e,s)=>(0,t.jsx)("li",{children:(0,t.jsxs)("a",{href:e.href,className:"relative flex items-center justify-center gap-x-2 text-gray-600 p-2 rounded-lg  hover:bg-gray-50 active:bg-gray-100 duration-150 group",children:[(0,t.jsx)("div",{className:"text-gray-500",children:e.icon}),(0,t.jsx)("span",{className:"absolute left-14 py-2 px-1.5 rounded-md whitespace-nowrap text-xs text-white bg-gray-800 hidden group-hover:inline-block group-focus:hidden duration-150",children:e.name})]})},s))}),(0,t.jsx)("div",{children:(0,t.jsxs)("ul",{className:"px-2 pb-4 text-sm font-medium gap-4 flex flex-col",children:[a&&x.loaded&&x.isAuthenticated&&x.userInfo&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("li",{children:(0,t.jsxs)("button",{className:"relative flex items-center justify-center text-gray-600 rounded-lg  hover:bg-gray-50 active:bg-gray-100 duration-150 group p-2",onClick:s,title:"Notifications",children:[(0,t.jsx)(c.A,{className:"w-6 h-6"}),u.unreadCount>0&&(0,t.jsx)("span",{className:"absolute top-1 right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white"}),u.unreadCount>9&&(0,t.jsx)("span",{className:"absolute top-0 right-0 text-[10px] font-bold text-white bg-red-500 rounded-full w-4 h-4 flex items-center justify-center border border-white",children:u.unreadCount>99?"99+":u.unreadCount})]})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"/zz/pages/portal/admin/profile",title:"Profile",className:"relative flex items-center justify-center text-gray-600 rounded-lg  hover:bg-gray-50 active:bg-gray-100 duration-150 group",children:(0,t.jsx)("img",{src:"/zz/profileImage/11/".concat(x.userInfo.name),alt:"profile",className:"w-8 h-8 rounded-full"})})})]}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",onClick:()=>{x.logOut(),m.push("/auth/login")},className:"relative flex items-center justify-center p-0.5 text-gray-600 rounded-lg  hover:bg-gray-50 active:bg-gray-100 duration-150 group",title:"Logout",children:(0,t.jsx)(d.A,{className:"w-6 h-6"})})})]})})]})]})})})},y=[{href:"/zz/pages/portal/admin",name:"Home",icon:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",strokeWidth:"1.5",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none",name:"home",className:"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})})},{href:"/zz/pages/portal/admin/spaces",name:"Spaces",icon:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.429 9.75L2.25 12l4.179 2.25m0-4.5l5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0l4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0l-5.571 3-5.571-3"})})},{href:"/zz/pages/portal/admin/store",name:"Store",icon:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.25 6.087c0-.355.186-.676.401-.959.221-.29.349-.634.349-1.003 0-1.036-1.007-1.875-2.25-1.875s-2.25.84-2.25 1.875c0 .369.128.713.349 1.003.215.283.401.604.401.959v0a.64.64 0 01-.657.643 48.39 48.39 0 01-4.163-.3c.186 1.613.293 3.25.315 4.907a.656.656 0 01-.658.663v0c-.355 0-.676-.186-.959-.401a1.647 1.647 0 00-1.003-.349c-1.036 0-1.875 1.007-1.875 2.25s.84 2.25 1.875 2.25c.369 0 .713-.128 1.003-.349.283-.215.604-.401.959-.401v0c.31 0 .555.26.532.57a48.039 48.039 0 01-.642 5.056c1.518.19 3.058.309 4.616.354a.64.64 0 00.657-.643v0c0-.355-.186-.676-.401-.959a1.647 1.647 0 01-.349-1.003c0-1.035 1.008-1.875 2.25-1.875 1.243 0 2.25.84 2.25 1.875 0 .369-.128.713-.349 1.003-.215.283-.4.604-.4.959v0c0 .333.277.599.61.58a48.1 48.1 0 005.427-.63 48.05 48.05 0 00.582-4.717.532.532 0 00-.533-.57v0c-.355 0-.676.186-.959.401-.29.221-.634.349-1.003.349-1.035 0-1.875-1.007-1.875-2.25s.84-2.25 1.875-2.25c.37 0 .713.128 1.003.349.283.215.604.401.96.401v0a.656.656 0 00.658-.663 48.422 48.422 0 00-.37-5.36c-1.886.342-3.81.574-5.766.689a.578.578 0 01-.61-.58v0z"})})},{href:"/zz/pages/portal/admin/users",name:"Users",icon:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 7.5a3 3 0 11-6 0 3 3 0 016 0zm-6 3a6.75 6.75 0 00-6.75 6.75v1.5A2.25 2.25 0 006.75 21h10.5a2.25 2.25 0 002.25-2.25v-1.5A6.75 6.75 0 0010.5 10.5zM12 12a4.5 4.5 0 100-9 4.5 4.5 0 000 9z"})})},{href:"/zz/pages/portal/admin/help",name:"Help",icon:(0,t.jsx)(o.A,{className:"w-6 h-6"})}];function N(){return(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsxs)("div",{className:"w-14 bg-white border-r border-gray-200 flex flex-col items-center py-4 space-y-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center"}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg animate-pulse"}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg animate-pulse"}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg animate-pulse"}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg animate-pulse"}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsx)("div",{className:"w-8 h-8 bg-green-400 rounded-full"}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-lg animate-pulse"})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 py-6 flex items-center justify-between w-full",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto w-full px-8 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 ",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-purple-200 rounded-lg flex items-center justify-center"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"w-20 h-5 bg-gray-200 rounded animate-pulse mb-1"}),(0,t.jsx)("div",{className:"w-32 h-3 bg-gray-200 rounded animate-pulse"})]})]}),(0,t.jsx)("div",{className:"w-24 h-8 bg-gray-200 rounded animate-pulse"})]})}),(0,t.jsxs)("div",{className:"flex-1 overflow-auto px-8 py-6",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,t.jsx)("div",{className:"w-full h-12 bg-white border border-gray-200 rounded-lg pl-12 animate-pulse"})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)("div",{className:"w-32 h-5 bg-gray-200 rounded animate-pulse"})}),(0,t.jsx)("div",{className:"w-32 h-6 bg-gray-200 rounded animate-pulse"})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-4",children:Array.from({length:10}).map((e,s)=>(0,t.jsxs)("div",{className:"bg-gradient-to-br rounded-xl p-6 w-full max-w-sm relative overflow-hidden shadow",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent animate-pulse"}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("div",{className:"flex items-center space-x-2 mb-4 pb-10",children:(0,t.jsx)("div",{className:"w-16 h-6 bg-purple-100/50 rounded-full animate-pulse"})})})]},s))})]})]})]})}},5705:(e,s,a)=>{Promise.resolve().then(a.bind(a,856))}},e=>{e.O(0,[3464,4212,4662,8738,8441,5964,7358],()=>e(e.s=5705)),_N_E=e.O()}]);